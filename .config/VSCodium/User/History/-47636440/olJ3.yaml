kind: Kustomization
apiVersion: kustomize.config.k8s.io/v1beta1

resources:
  - ../../base/
  - ./resources/phpmyadmin-basic-auth-secret.yaml

patches:
  - path: ./nextcloud-server-ingress.patch.yaml
    target:
      name: nextcloud-server
      kind: Ingress
  - path: ./keycloak-ingress.patch.yaml
    target:
      name: keycloak
      kind: Ingress
  - path: ./phpmyadmin-ingress.patch.yaml
    target:
      name: phpmyadmin
      kind: Ingress

images:
  - name: gitlab.publicplan.cloud:5050/themenwelt-kommunales/nextcloud-server
    newName: gitlab.publicplan.cloud:5050/themenwelt-kommunales/nextcloud-server
    newTag: v31.0.2

configMapGenerator:
  - name: nextcloud-server-config
    envs:
      - mixins/nextcloud-server-config.env
    options:
      disableNameSuffixHash: true
