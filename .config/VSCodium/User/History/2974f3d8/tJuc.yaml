---
- name: Run debug tasks
  hosts: all
  gather_facts: false
  become: true
  tasks:
    - name: Detect latest Kubernetes version
      ansible.builtin.shell: |
        set -o pipefail
        apt-cache madison kubeadm | grep -F '1.31' | head -1 | awk '{print $3}'
      args:
        executable: /bin/bash
      changed_when: true
      register: kube_version_long

- name: Print debug msg
  hosts: all
  gather_facts: false
  become: true
  tasks:
    - name: Print
      ansible.builtin.debug:
        msg: "{{ kube_version_long }}"
