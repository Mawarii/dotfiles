kind: Kustomization
apiVersion: kustomize.config.k8s.io/v1beta1

resources:
  - ../../base

images:
  - name: DOCKER_IMAGE_1
    newName: gitlab.publicplan.cloud:5050/regmo/sdg-backend
    newTag: 2e12be8e

patches:
  - path: deployment.patch.yaml
    target:
      kind: Deployment
      name: sdg-backend
  - path: ingress.patch.yaml
    target:
      kind: Ingress
      name: sdg-backend-ingress
  - path: mariadb-secret.patch.yaml
    target:
      kind: Secret
      name: mariadb
  - path: redis-secret.patch.yaml
    target:
      kind: Secret
      name: redis

secretGenerator:
  - name: gitlab-registry-sdg-backend
    type: kubernetes.io/dockerconfigjson
    files:
      - ./mixins/.dockerconfigjson
    options:
      disableNameSuffixHash: true
