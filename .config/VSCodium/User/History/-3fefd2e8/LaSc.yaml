apiVersion: v1
kind: ConfigMap
metadata:
  name: settings
data:
  settings.cluster.php: |
    <?php
    $databases['default']['default'] = [
       'database' => $_ENV['MYSQL_DATABASE'],
       'username' => $_ENV['MYSQL_USER'],
       'password' => $_ENV['MYSQL_PASSWORD'],
       'host' => $_ENV['MYSQL_HOST'],
       'port' => '3306',
       'driver' => 'mysql',
       'prefix' => '',
       'collation' => 'utf8mb4_general_ci',        
    ];

    $settings['reverse_proxy'] = TRUE;
    $settings['reverse_proxy_addresses'] = array($_SERVER['REMOTE_ADDR']);
    $settings['reverse_proxy_trusted_headers'] = \Symfony\Component\HttpFoundation\Request::HEADER_X_FORWARDED_HOST |
        \Symfony\Component\HttpFoundation\Request::HEADER_X_FORWARDED_PORT |
        \Symfony\Component\HttpFoundation\Request::HEADER_X_FORWARDED_PROTO |
        \Symfony\Component\HttpFoundation\Request::HEADER_X_FORWARDED_FOR;
