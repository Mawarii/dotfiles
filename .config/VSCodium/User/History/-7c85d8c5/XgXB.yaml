---
# - name: Create sshd configuration file
#   ansible.builtin.template:
#     src: ./templates/sshd_config.j2
#     dest: /etc/ssh/sshd_config.d/shield.conf
#     owner: root
#     group: root
#     mode: '0600'

## TODO: Get Hetzner Cloud firewall and replace ssh port rule if hcloud token is set
- name: Gather Hetzner Cloud firewall info
  when: hcloud_token != ""
  hetzner.hcloud.firewall_info:
    api_token: "{{ hcloud_token }}"
  register: output

- name: Print the gathered info
  ansible.builtin.debug:
    msg: "{{ output.hcloud_firewall_info | map(attribute='rules', default=[]) }}"
