apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: customercluster-empfangsclient-keycloak
    namespace: argocd
spec:
    destination:
        namespace: empfangsclient-keycloak
        name: publicplan-customer
    project: customercluster-projects-empfangsclient
    sources:
        -   targetRevision: HEAD
            repoURL: git@gitlab.publicplan.cloud:themenwelt-portalverbund/empfangs-client/kubernetes-dist.git
            path: keycloak/resources
        -   repoURL: 'https://charts.bitnami.com/bitnami'
            targetRevision: 19.4.1
            helm:
                valueFiles:
                    - $values/keycloak/values.yaml
            chart: keycloak
        -   repoURL: git@gitlab.publicplan.cloud:themenwelt-portalverbund/empfangs-client/kubernetes-dist.git
            targetRevision: HEAD
            ref: values
    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
